<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Game with Random Sign Indices + Radio Buttons</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background-color: black;
      color: #FAFAFA;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
      text-align: center;
    }

    /* Top buttons container */
    #topButtons {
      margin-top: 1rem;
    }

    button {
      font-size: 1.2rem;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #007BFF;
      color: white;
      transition: background 0.3s;
      margin: 0.5rem;
    }
    button:hover {
      background: #0056b3;
    }

    h1 {
      margin: 1rem 0 0.5rem 0;
    }

    #sign {
      margin-top: 2rem;
      font-size: 1.5rem;
      font-weight: bold;
      color: #fff;
      text-shadow:
        -1px 0 red,
         1px 0 red,
         0 -1px red,
         0  1px red;
      -webkit-text-stroke: 1px red;
      -webkit-text-fill-color: #fff;
      min-height: 2em; /* Reserve space even when empty */
    }

    #playedSigns {
      margin-top: 2rem;
      width: 80%;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }

    #playedSigns p {
      margin: 0.5rem 0;
      color: #FAFAFA;
      font-size: 1.2rem;
    }

    /* Container for the radio button choices */
    #choiceContainer {
      margin-top: 2rem;
    }
    .choiceItem {
      margin: 0.5rem 0;
      display: block; /* each choice on its own line */
    }
    label {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Listen and Watch the Screen</h1>

  <!-- Top buttons, including "Restart" -->
  <div id="topButtons">
    <button id="playBtn">Play / Stop</button>
    <button onclick="location.reload()">Restart Game</button>
  </div>

  <!-- Current sign with stroke effect -->
  <div id="sign"></div>

  <!-- Container for played signs in plain white text -->
  <div id="playedSigns"></div>

  <!-- Container for the radio button choices (will appear after 4 signs) -->
  <div id="choiceContainer"></div>

  <audio id="audioElement"></audio>

  <script>
    // 1) The master list of possible signs (text strings)
    const possibleSigns = [
      "That is embarrassing",
      "that isn’t my receipt",
      "lactates in pharmacy",
      "baptism piracy",
      "that isn’t parsley",
      "bart simpson bouncing",
      "rats eating pirate shit",
      "five, six, six, five or six",
      "that isn’t bouncing",
      "nazis in pirate ships",
      "that isn’t piracy",
      "Battles and Parasites"
    ];

    // 2) Audio playlist (4 clips)
    const audioPlaylist = [
      "audio/clip1.mp3",
      "audio/clip2.mp3",
      "audio/clip3.mp3",
      "audio/clip4.mp3"
    ];

    // Elements
    const audioEl      = document.getElementById("audioElement");
    const signEl       = document.getElementById("sign");
    const playBtn      = document.getElementById("playBtn");
    const playedSignsContainer = document.getElementById("playedSigns");
    const choiceContainer = document.getElementById("choiceContainer");

    // We'll store the 4 chosen indices + their corresponding text
    let chosenSignIndexes = [];
    let chosenSigns = []; // text strings derived from chosenSignIndexes

    let currentIndex = 0;   // which audio clip is currently playing
    let isFirstPlay = true; // so we only pick random signs once

    // Shuffle utility (Fisher-Yates)
    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // 3) Pick 4 random *indices*, store them in chosenSignIndexes
    function pickRandomSignIndexes() {
      // We only need 4 unique indexes out of possibleSigns' length
      const total = possibleSigns.length;
      // Build an array of all indexes [0..n-1], shuffle it, then slice first 4
      let allIndexes = Array.from({length: total}, (_,i)=>i);
      shuffleArray(allIndexes);
      return allIndexes.slice(0,4);
    }

    function loadTrack(index) {
      if (index < audioPlaylist.length) {
        audioEl.src = audioPlaylist[index];
        // Display the stroke text for the current sign
        signEl.textContent = chosenSigns[index];
      } else {
        audioEl.src = "";
        signEl.textContent = "";
      }
    }

    // 4) "Play" button
    playBtn.addEventListener("click", () => {
      if (isFirstPlay) {
        // a) pick 4 random indexes
        chosenSignIndexes = pickRandomSignIndexes();
        // b) derive the chosen sign texts from those indexes
        chosenSigns = chosenSignIndexes.map(i => possibleSigns[i]);
        // c) shuffle chosenSigns if you want them in a random order each time
        shuffleArray(chosenSigns);

        // d) load the first track
        loadTrack(currentIndex);
        isFirstPlay = false;
      }
      // Play
      audioEl.play();
      playBtn.disabled = true;
    });

    // 5) Each time a clip ends:
    audioEl.addEventListener("ended", () => {
      // Append the just-played sign in plain white to #playedSigns
      const p = document.createElement("p");
      p.textContent = chosenSigns[currentIndex];
      playedSignsContainer.appendChild(p);

      // Move on
      currentIndex++;
      if (currentIndex < audioPlaylist.length) {
        loadTrack(currentIndex);
        audioEl.play();
      } else {
        // We have displayed all 4 signs.
        signEl.textContent = ""; // Clear the stroke effect area

        // Now that all 4 are shown, let's create radio buttons
        createRadioButtons();
      }
    });

    audioEl.addEventListener("pause", () => {
      // Allow user to un-pause
      playBtn.disabled = false;
    });

    // 6) Create radio button choices for the 4 displayed signs
    //    The user can pick exactly one of them.
    function createRadioButtons() {
      // Clear out #choiceContainer in case we do this multiple times (optional)
      choiceContainer.innerHTML = "";

      // Maybe add a heading or instructions
      const info = document.createElement("p");
      info.textContent = "Choose one of the 4 displayed signs:";
      choiceContainer.appendChild(info);

      // For each chosen sign, create a radio input + label
      chosenSigns.forEach((signText, index) => {
        const div = document.createElement("div");
        div.classList.add("choiceItem");

        const input = document.createElement("input");
        input.type = "radio";
        input.name = "signSelection";
        input.id = "signOption" + index;
        // 'value' could store the sign text or the chosenSignIndex
        input.value = signText; 
        // If you prefer the numeric index from possibleSigns, use:
        // input.value = chosenSignIndexes[index];

        const label = document.createElement("label");
        label.htmlFor = input.id;
        label.textContent = signText;

        // Append radio + label
        div.appendChild(input);
        div.appendChild(label);

        choiceContainer.appendChild(div);
      });
    }
  </script>
</body>
</html>
